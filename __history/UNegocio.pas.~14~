unit UNegocio;

interface

uses
  UDados, Data.DB, System.SysUtils,
  System.Classes, IdHTTPServer, IdContext, IdCustomHTTPServer, IdGlobal, System.JSON,
  FireDAC.Comp.Client, FireDAC.Comp.DataSet, FireDAC.Stan.Param, FireDAC.Stan.Intf;

type
  TClienteNegocio = class
  public
    function ListarClientes: TDataSet;
    function DeleteClientById(const ClientId: string): Boolean;
  end;

implementation

function TClienteNegocio.DeleteClientById(const ClientId: string): Boolean;
begin
  var
  Query: TFDQuery;
begin
  Result := False;

  Query := TFDQuery.Create(nil);
  try
    Query.Connection := FDConnection1;
    Query.SQL.Text := 'DELETE FROM clientes WHERE id = :id';
    Query.ParamByName('id').AsString := ClientId;
    Query.ExecSQL;

    // Verificar se alguma linha foi afetada
    Result := Query.RowsAffected > 0;
  finally
    Query.Free;
  end;
end;

function TClienteNegocio.ListarClientes: TDataSet;
begin
  if not DataModuleDB.Conectar then
    raise Exception.Create('Erro ao conectar ao banco de dados');

  Result := DataModuleDB.ExecutarQuery('SELECT * FROM PESSOA');
end;



end.

